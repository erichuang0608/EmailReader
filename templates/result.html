<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>分析结果</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        pre {background: #f6f8fa; padding: 1em; border-radius: 6px;}
        .error {color: red;}
        .section {margin-bottom: 2em;}
        .section h3 {margin-bottom: 0.5em; color: #0078d4;}
        table {border-collapse: collapse; width: 100%; background: #fff;}
        th, td {border: 1px solid #e0e0e0; padding: 0.5em;}
        th {background: #f0f4f8;}
    </style>
</head>
<body>
    <h2>分析结果</h2>
    {% if error %}
        <div class="error">{{ error }}</div>
    {% else %}
        <div class="section">
            <h3>邮件基本信息</h3>
            <ul>
                <li><b>主题：</b>{{ result.metadata.subject }}</li>
                <li><b>发件人：</b>{{ result.metadata.from }}</li>
                <li><b>收件人：</b>{{ result.metadata.to | join(', ') }}</li>
                <li><b>时间：</b>{{ result.metadata.date }}</li>
            </ul>
        </div>
        <div class="section">
            <h3>正文摘要</h3>
            <div><b>摘要：</b>{{ result.body.summary }}</div>
            <details style="margin-top:0.5em;"><summary>显示原文</summary><pre>{{ result.body.raw_text }}</pre></details>
        </div>
        {% if result.attachments and result.attachments|length > 0 %}
        <div class="section">
            <h3>附件摘要</h3>
            <table>
                <tr><th>文件名</th><th>类型</th><th>摘要</th></tr>
                {% for att in result.attachments %}
                <tr>
                    <td>{{ att.filename }}</td>
                    <td>{{ att.type }}</td>
                    <td>{{ att.summary }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
        {% endif %}
        <div class="section">
            <h3>关键信息提取</h3>
            <ul>
                <li><b>人物：</b>{{ result.analysis.entities.persons | default('无') | join(', ') if result.analysis.entities.persons is defined else '无' }}</li>
                <li><b>组织：</b>{{ result.analysis.entities.organizations | default('无') | join(', ') if result.analysis.entities.organizations is defined else '无' }}</li>
                <li><b>日期：</b>{{ result.analysis.entities.dates | default('无') | join(', ') if result.analysis.entities.dates is defined else '无' }}</li>
                <li><b>地点：</b>{{ result.analysis.entities.locations | default('无') | join(', ') if result.analysis.entities.locations is defined else '无' }}</li>
            </ul>
        </div>
        <div class="section">
            <h3>行动项</h3>
            {% if result.analysis.action_items and result.analysis.action_items|length > 0 %}
            <table>
                <tr><th>描述</th><th>负责人</th><th>截止日期</th><th>优先级</th></tr>
                {% for item in result.analysis.action_items %}
                <tr>
                    <td>{{ item.description }}</td>
                    <td>{{ item.assignee }}</td>
                    <td>{{ item.due_date }}</td>
                    <td>{{ item.priority }}</td>
                </tr>
                {% endfor %}
            </table>
            {% else %}
            <div>无</div>
            {% endif %}
        </div>
        <div class="section">
            <h3>情绪分析</h3>
            <div>{{ result.analysis.sentiment }}</div>
        </div>
        <div class="section">
            <h3>风险点</h3>
            {% if result.analysis.risk_points and result.analysis.risk_points|length > 0 %}
                <ul>
                {% for risk in result.analysis.risk_points %}
                    <li>{{ risk }}</li>
                {% endfor %}
                </ul>
            {% else %}
                <div>无</div>
            {% endif %}
        </div>
    {% endif %}
    <a href="/">返回上传</a>
</body>
</html> 